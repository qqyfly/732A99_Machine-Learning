---
title: "Machine Learning Computer Lab 1 (Group A7)"
author: 
  - Qinyuan Qi(qinqi464)
  - Satya Sai Naga Jaya Koushik	Pilla (satpi345)
  - Daniele	Bozzoli(danbo826)  
date: "2023-11-19"
output: pdf_document
---

```{r setup, include=FALSE}
###########################  Init code #########################################
knitr::opts_chunk$set(echo = TRUE)
rm(list = ls())
```

## Assignment 1: Handwritten digit recognition with K- nearest neighbors  (Solved by Qinyuan Qi - qinqi464)

\textbf{\textcolor{blue}{Answer:}}

\textbf{(1)}

```{r 1.1}
######################  Assignment 1.1 #########################################
# read data
data <- read.csv("./Homework/Lab/Lab1/optdigits.csv")
row_num <- nrow(data)
cols_num <- ncol(data)

# set the last column name as "label_value" since we need to create a formula
names(data)[cols_num] <- "label_value"

# set data split ratio to 0.5, 0.25 and 0.25
ratio <- c(train = .5, test = .25, validate = .25)

# data pre-processing
# columns 1-64 are number based and do not need to be normalized, last column
# is integer represent number from 0-9 which don't need to process again

# set random seed
set.seed(12345)

# split data to training, test and validation set
train_id <- sample(1:row_num, floor(row_num * ratio[1]))
train_set <- data[train_id, ]

set.seed(12345)
test_val_id <- setdiff(1:row_num, train_id)
test_id <- sample(test_val_id, floor(row_num * ratio[2]))
test_set <- data[test_id, ]

valid_id <- setdiff(test_val_id, test_id)
valid__set <- data[valid_id, ]
```

\textbf{(2)}

The following code contain a function call to kknn with k=30 and kernel = ”rectangular”. We calculate the confusion matrices and the misclassification errors. The code as below.

```{r 1.2}
# calculate error rate for k = 30
k_value <- 30
fit_kknn <- kknn::kknn(label_value ~ .,
                       train_set,
                       test_set,
                       k = k_value,
                       distance = 1,
                       kernel = "rectangular")

fit <- fitted(fit_kknn)

# generate confusion matrix
confusion_matrices <- table(round(fit), test_set$label_value)

# calculate accuracy
accuracy <- sum(diag(confusion_matrices)) / sum(confusion_matrices)

# calculate error rate
error_rate <- 1 - accuracy
```

The confusion_matrices is as follows:

|   | 0 | 1 | 2 | 3 | 4 | 5 | 6 | 7 | 8 | 9 |
|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|:-:|
| 0 |97 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| 1 | 2 |80 | 0 | 0 | 0 | 0 | 1 | 0 | 0 | 0 |
| 2 | 0 |20 |91 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| 3 | 0 | 1 | 9 |57 | 0 | 0 | 0 | 0 | 3 | 1 |
| 4 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| 5 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| 6 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| 7 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| 8 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |
| 9 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 | 0 |

The error_rate is.



\textbf{(3)}

\textbf{(4)}

\textbf{(5)}